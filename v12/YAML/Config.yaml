# 全局设置 - 所有TASK共用
settings:
  show_progress: true    # 是否显示进度条 - 所有TASK
  debug: false          # 调试模式开关 - 所有TASK
  log_dir: LOG          # 日志目录 - 所有TASK
  report_dir: REPORT    # 报告目录 - 所有TASK
  # 平台网段映射配置 - 公共配置，多个任务共用
  # Sheet名称（站点名）到平台网段的映射，用于识别各站点的平台网段
  platform_network_map:
    HX00:
      - "10.10.0.0/16"
    HX01:
      - "10.6.0.0/16"
    HX02:
      - "10.12.0.0/16"
    HX03:
      - "10.13.0.0/16"
    HX04:
      - "10.60.0.0/16"
      - "10.62.0.0/16"
    HX05:
      - "10.65.0.0/16"
    HX06:
      - "10.66.0.0/16"
    HX11:
      - "10.70.0.0/16"
    P4:
      - "10.80.0.0/16"
# 任务开关配置 - 控制哪些任务执行
# 设置为 false 可禁用对应任务，设置为 true 可启用对应任务

task_switches:
  FXOSWebTask: true                   # FXOS设备Web巡检
  MirrorFortiGateTask: true           # FortiGate设备镜像巡检
  OxidizedTask: true                 # Oxidized配置备份巡检
  ESLogstashTask: true               # Logstash服务器巡检
  ESBaseTask: true                   # Elasticsearch基础巡检
  ESN9KLOGInspectTask: true          # ES N9K日志检查
  ESFlowTask: true                   # Flow服务器巡检
  DeviceBackupTask: true             # 设备备份任务
  DeviceDIFFTask: true               # 设备差异检查
  ASACompareTask: true               # ASA防火墙对比检查
  ACLDupCheckTask: true              # ACL重复检查任务
  ACLArpCheckTask: true              # ACL无ARP匹配检查任务
  ACLCrossCheckTask: true            # N9K&LINKAS ACL交叉检查任务
  ASADomainCheckTask: true           # ASA域名提取和检测任务
  ASATempnetworkCheckTask: true       # ASA临时出网地址检查任务
  ServiceCheckTask: true             # 服务检查任务(NTP TACACS+)
  LogRecyclingTask: true             # 日志回收任务（月底最后一天执行）
# 系统性能配置 - base.py调用
timeouts:
  ssh: 12              # SSH连接超时(秒) - MirrorFortiGateTask, ESLogstashTask, ESBaseTask, ESFlowTask
  http: 12             # HTTP请求超时(秒) - OxidizedTask, ESN9KLOGInspectTask
  page_goto: 60000     # 页面加载超时(毫秒) - FXOSWebTask
  selector: 30000      # 元素选择超时(毫秒) - FXOSWebTask
# 网络配置 - OxidizedTask, FXOSWebTask调用
network:
  max_workers: 2        # 最大并发工作线程数 - OxidizedTask
  delay_range: [0.30, 0.80]  # 请求间隔随机延时范围(秒) - OxidizedTask
  block_resources:      # 拦截的资源类型 - FXOSWebTask
    - image
    - media
    - font
progress:              # 进度条配置 - base.py调用
  show_percentage: true    # 显示百分比 - 所有TASK
  show_bar: true          # 显示进度条 - 所有TASK
  show_count: true        # 显示计数 - 所有TASK
  show_elapsed: true      # 显示耗时 - 所有TASK
  show_remaining: true     # 显示剩余时间 - 所有TASK
  bar_length: 25          # 进度条长度 - 所有TASK
  prefix: "==="          # 前缀 - 所有TASK
  suffix: "==="          # 后缀 - 所有TASK
  elapsed_label: "当前耗时"        # 耗时标签 - 所有TASK
  remaining_label: "剩余耗时"  # 剩余时间标签 - 所有TASK
# 环境依赖配置 - RuntimeEnvCheck.py调用
dependencies:
  yaml: pyyaml          # YAML解析库 - 所有TASK
  tqdm: tqdm           # 进度条库 - 所有TASK
  requests: requests   # HTTP请求库 - OxidizedTask, ESN9KLOGInspectTask
  urllib3: urllib3     # HTTP客户端库 - OxidizedTask (requests的依赖，但代码中直接导入)
  lxml: lxml          # XML/HTML解析库 - OxidizedTask
  paramiko: paramiko  # SSH连接库 - MirrorFortiGateTask, ESLogstashTask, ESBaseTask, ESFlowTask
  playwright: playwright  # Web自动化库 - FXOSWebTask
  openpyxl: openpyxl  # Excel操作库 - DeviceBackupTask, DeviceDIFFTask, ASACompareTask, ACL任务
  xlsxwriter: xlsxwriter  # Excel写入库 - ACLArpCheckTask
pip_mirrors:           # pip镜像源 - RuntimeEnvCheck.py调用
  - https://pypi.org/simple/                    # 官方源
  - https://mirrors.aliyun.com/pypi/simple/     # 阿里云镜像
  - https://pypi.tuna.tsinghua.edu.cn/simple/   # 清华镜像
check:                 # 网络检查配置 - RuntimeEnvCheck.py调用
  timeout: 10         # 网络检查超时(秒)
  retry_times: 3      # 重试次数
# FXOS设备配置 - FXOSWebTask调用
FXOSWebTask:
  username: admin      # FXOS登录用户名
  password: enc:KAoeGQtSRlo=   # FXOS登录密码
  devices:            # FXOS设备列表
    HX00-FXOS-01: https://10.10.88.246/
    HX00-FXOS-02: https://10.10.88.245/
    HX00-FXOS-BK: https://10.10.88.243/
    HX01-FXOS-01: https://10.6.88.246/
    HX01-FXOS-02: https://10.6.88.245/
    HX01-FXOS-BK: https://10.6.88.243/
    HX02-FXOS-01: https://10.12.88.213/
    HX02-FXOS-02: https://10.12.88.215/
    HX02-FXOS-BK: https://10.12.88.243/
    HX03-FXOS-01: https://10.13.88.247/
    HX03-FXOS-02: https://10.13.88.246/
    HX03-FXOS-BK: https://10.13.88.241/
    HX04-FXOS-01: https://10.62.88.245/
    HX04-FXOS-02: https://10.62.88.244/
    HX04-FXOS-BK: https://10.62.88.242/
    HX05-FXOS-01: https://10.65.88.245/
    HX05-FXOS-02: https://10.65.88.244/
    HX05-FXOS-BK: https://10.65.88.212/
    HX06-FXOS-01: https://10.66.88.211/
    HX06-FXOS-02: https://10.66.88.213/
    HX06-FXOS-BK: https://10.66.88.221/
# FortiGate设备配置 - MirrorFortiGateTask调用
MirrorFortiGateTask:
  username: admin        # FortiGate登录用户名
  password: enc:KAoeGQsjRVpaWRQ=  # FortiGate登录密码
  port: 22              # SSH端口
  hosts:                # FortiGate设备IP列表
    - 10.10.88.247
    - 10.6.88.247
    - 10.12.88.251
    - 10.13.88.251
    - 10.62.88.251
    - 10.65.88.251
    - 10.66.88.251
  thresholds:          # FortiGate告警阈值
    cpu_percent:       # CPU使用率阈值
      warn: 50         # 告警阈值
      crit: 80         # 严重阈值
    mem_percent:       # 内存使用率阈值
      warn: 50         # 告警阈值
      crit: 80         # 严重阈值
    disk_percent:      # 磁盘使用率阈值
      warn: 60         # 告警阈值
      crit: 80         # 严重阈值
    uptime_days:       # 运行时间阈值
      min: 3           # 最小运行天数
# Oxidized配置备份 - OxidizedTask调用
OxidizedTask:
  base_urls:           # Oxidized服务URL列表
    - http://10.10.80.11:8888/nodes
    - http://10.10.80.12:8888/nodes
    - http://10.10.80.13:8888/nodes
    - http://10.10.80.14:8888/nodes
  ignore_device_prefixes:  # 忽略的设备前缀列表
    - HX07              # 忽略HX07开头的所有设备
    - FG                # 忽略FG开头的所有设备
# 服务器配置 - ESLogstashTask, ESBaseTask, ESFlowTask调用
ESServer:
  port: 22             # SSH端口
  thresholds:          # 服务器告警阈值
    disk_percent:      # 磁盘使用率阈值(通用)
      warn: 50         # 告警阈值
      crit: 80         # 严重阈值
    mem_percent:       # 内存使用率阈值(按服务类型)
      ESLogstashTask:  # Logstash服务器内存阈值
        warn: 50       # 告警阈值
        crit: 80       # 严重阈值
      ESBaseTask:      # Elasticsearch服务器内存阈值
        warn: 80       # 告警阈值
        crit: 90       # 严重阈值
      ESFlowTask:      # Flow服务器内存阈值
        warn: 80       # 告警阈值
        crit: 90       # 严重阈值
  ESLogstashTask:      # Logstash服务器配置
    username: root     # SSH用户名
    password: enc:KAoeGQsjRVtcXh1Y  # SSH密码
    hosts:             # Logstash服务器列表
      HX00-LOGSTASH: 10.10.86.101
      HX01-LOGSTASH: 10.6.86.32
      HX02-LOGSTASH: 10.10.86.111
      HX03-LOGSTASH: 10.10.86.116
      HX04-LOGSTASH: 10.62.86.2
      HX05-LOGSTASH: 10.6.86.52
      HX06-LOGSTASH: 10.6.86.62
  ESBaseTask:          # Elasticsearch服务器配置
    username: root     # SSH用户名
    password: enc:KAoeGQsjRVtcXh1Y  # SSH密码
    hosts:             # ES服务器列表
      HX00-ES: 10.10.86.100
      HX01-ES: 10.6.86.31
      HX02-ES: 10.10.86.110
      HX03-ES: 10.10.86.115
      HX04-ES: 10.62.86.1
      HX05-ES: 10.6.86.51
      HX06-ES: 10.6.86.61
  ESFlowTask:          # Flow服务器配置
    username: root     # SSH用户名
    password: enc:KAoeGQsjRVtcXh1Y  # SSH密码
    hosts:             # Flow服务器列表
      HX00-FLOW: 10.10.86.102
      HX01-FLOW: 10.6.86.33
      HX02-FLOW: 10.10.86.112
      HX03-FLOW: 10.10.86.117
      HX04-FLOW: 10.62.86.3
      HX05-FLOW: 10.6.86.53
      HX06-FLOW: 10.6.86.63
  ESFlowTask_CustomParameters:  # Flow服务检查配置 - ESFlowTask调用
    require_ports:      # 必需端口列表
      - 5601           # Kibana端口
      - 9200           # Elasticsearch HTTP端口
      - 9300           # Elasticsearch传输端口
    require_containers: # 必需容器列表
      - opt-kibana-1
      - elastiflow-logstash
      - opt-elasticsearch-1
    index_prefix: elastiflow-4.0.1-  # 索引前缀
    index_size_limit_bytes: 1073741824  # 索引大小限制(1GB)
    segment_max_non_recent: 3          # 最大非最近段数
# ES N9K日志检查 - ESN9KLOGInspectTask调用
ESN9KLOGInspectTask:
  ignore_alarm_file: YAML/Ignore_alarm.yaml  # 忽略告警配置文件
  kibana_bases:        # Kibana服务地址列表
    HX00-ES: http://10.10.86.100:5601
    HX01-ES: http://10.6.86.31:5601
    HX02-ES: http://10.10.86.110:5601
    HX03-ES: http://10.10.86.115:5601
    HX04-ES: http://10.62.86.1:5601
    HX05-ES: http://10.6.86.51:5601
    HX06-ES: http://10.6.86.61:5601
  index_pattern: '*-n9k-*-*'  # 索引模式匹配
  time_gte: now-3d            # 时间范围开始(3天前)
  time_lt: now                # 时间范围结束(现在)
 
# ACL重复检查任务 - ACLDupCheckTask调用
ACLDupCheckTask:
  enable_summary_output: false                           # 是否输出汇总统计（false=不输出，true=输出到LOG文件）

# N9K&LINKAS ACL交叉检查任务 - ACLCrossCheckTask调用
# 接入层同平台策略配置 - 使用公共配置 settings.platform_network_map
# 只对以下Sheet进行同平台策略检测，如果Sheet不在映射中则不检测
# 平台特殊地址段配置 - Sheet名称到特殊地址段的映射
# 用于步骤8：特殊规则检查（cat1源地址为本平台地址，目的地址为特殊规则定义IP段地址）
ACLCrossCheckTask:
  special_network_map:
    HX00:
      - "10.10.26.0/24"
      - "10.10.14.0/24"
      - "10.10.17.0/24"
      - "10.10.11.0/24"
      - "10.10.13.0/24"
      - "10.10.5.0/24"
      - "10.10.19.0/24"
    HX01:
      - "10.6.16.0/24"
      - "10.6.11.0/24"
      - "10.6.12.0/24"
      - "10.6.13.0/24"
      - "10.6.20.0/24"
      - "10.6.21.0/24"
      - "10.6.22.0/24"
      - "10.6.24.0/24"
      - "10.6.25.0/24"
      - "10.6.27.0/24"
      - "10.6.200.0/24"
    HX02:
      - "10.12.16.0/24"
      - "10.12.11.0/24"
      - "10.12.12.0/24"
      - "10.12.13.0/24"
      - "10.12.14.0/24"
      - "10.12.17.0/24"
      - "10.12.18.0/24"
      - "10.12.21.0/24"
      - "10.12.22.0/24"
      - "10.12.31.0/24"
      - "10.12.76.0/24"
      - "10.12.100.0/24"
      - "10.12.200.0/24"
    HX03:
      - "10.13.16.0/24"
      - "10.13.11.0/24"
      - "10.13.12.0/24"
      - "10.13.13.0/24"
      - "10.13.18.0/24"
      - "10.13.19.0/24"
      - "10.13.21.0/24"
      - "10.13.22.0/24"
      - "10.13.31.0/24"
      - "10.13.200.0/24"
      - "10.13.211.0/24"
    HX04:
      - "10.62.16.0/24"
    HX05:
      - "10.65.16.0/24"
    HX06:
      - "10.66.16.0/24"
      - "10.66.7.0/24"
      - "10.66.214.0/24"
      - "10.66.244.0/24"
    P4:
      - "10.80.16.0/24"

# ACL无ARP匹配检查任务 - ACLArpCheckTask调用
ACLArpCheckTask:
  ignore_third_octet: [86, 88, 108, 153]                 # 忽略第三段为特定地址段的IP
  enable_summary_output: false                           # 是否输出汇总统计（false=不输出，true=输出到LOG文件）
  # 注意：ARP检测范围使用公共配置 settings.platform_network_map，只检测在平台网段内的网络

# ASA域名提取和检测任务 - ASADomainCheckTask调用
# 开关只放这里；实际文件路径在代码中写死
ASADomainCheckTask:
  enable_domain_scripts: true        # 是否生成"操作/回退脚本"
  use_manual_source_first: true      # 是否优先使用手工清单(ManualDomainRecovery.log)

# 日志回收任务 - LogRecyclingTask调用
# 指定运行日期（YYYYMMDD格式，例如: 20251028）
# 默认规则（写死在代码中）：月底最后一天执行
# 如果设置为 null 或不设置，则使用默认规则（月底最后一天执行）
# 如果设置为具体日期，则只在指定日期执行（覆盖默认规则）
LogRecyclingTask:
  force_run_date: null               # 指定运行日期，null或不设置则使用默认规则（月底最后一天）

